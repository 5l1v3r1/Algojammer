<!DOCTYPE html>
<html>
    <head>
        <title>Timeline</title>
        <link rel='stylesheet' type='text/css' href='/sheet/sheet.css'>
        <link rel='stylesheet' type='text/css' href='/sheet/timeline.css'>

        <script type='text/javascript' src='/eel.js'></script>
        <script type='text/javascript' src='/lib/jquery.js'></script>
        
        <script type='text/javascript' src='/constants.js'></script>
        <script type='text/javascript' src='/algojammer.js'></script>
        <script type='text/javascript' src='/sheet/sheet.js'></script>
    </head>
    
    <body>
    	<canvas id='sheet-canvas'></canvas>
        <script type='text/javascript'>

var timeline = document.getElementById('sheet-canvas');
var last_callback_time = 0;

function handle_scroll(evt) {
    evt.preventDefault();
    if (!evt){
        evt = event;
    }
    var direction = (evt.detail < 0 || evt.wheelDelta > 0) ? 1 : -1;
    if(Date.now() - last_callback_time > 100) {
        // Only fire this event every 100ms (cross-platform homogenising)
        eel.timeline_zoom(direction);
        last_callback_time = Date.now();
    }
};

// Zooming
timeline.addEventListener('DOMMouseScroll', handle_scroll, false);
timeline.addEventListener('mousewheel', handle_scroll, false);
timeline.addEventListener('wheel', handle_scroll, false);

// Dragging
timeline.addEventListener('mousedown', function(e){
    eel.timeline_click(e.screenX, e.screenY, true);
}, false);
window.addEventListener('mouseup', function(e){
    eel.timeline_click(e.screenX, e.screenY, false);
}, false);

        </script>
    </body>
</html>